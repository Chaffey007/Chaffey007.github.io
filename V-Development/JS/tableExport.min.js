(function(a){a.fn.extend({tableExport:function(i){var p={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"};var i=a.extend(p,i);var e=this;if(p.type=="csv"||p.type=="txt"){var h="";a(e).find("thead").find("tr").each(function(){h+="\n";a(this).filter(":visible").find("th").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){h+='"'+m(a(this))+'"'+p.separator}}});h=a.trim(h);h=a.trim(h).substring(0,h.length-1)});a(e).find("tbody").find("tr").each(function(){h+="\n";a(this).filter(":visible").find("td").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){h+='"'+m(a(this))+'"'+p.separator}}});h=a.trim(h).substring(0,h.length-1)});if(p.consoleLog=="true"){console.log(h)}var c=new Blob([h],{type:"text/csv"});if(window.navigator.msSaveBlob){window.navigator.msSaveOrOpenBlob(c,"exportData"+new Date().toDateString()+".csv")}else{var s=window.document.createElement("a");s.href=window.URL.createObjectURL(c,{type:"text/plain"});s.download="exportData"+new Date().toDateString()+".csv";document.body.appendChild(s);s.click();document.body.removeChild(s)}}else{if(p.type=="sql"){var h="INSERT INTO `"+p.tableName+"` (";a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){h+="`"+m(a(this))+"`,"}}});h=a.trim(h);h=a.trim(h).substring(0,h.length-1)});h+=") VALUES ";a(e).find("tbody").find("tr").each(function(){h+="(";a(this).filter(":visible").find("td").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){h+='"'+m(a(this))+'",'}}});h=a.trim(h).substring(0,h.length-1);h+="),"});h=a.trim(h).substring(0,h.length-1);h+=";";if(p.consoleLog=="true"){console.log(h)}var d="base64,"+a.base64.encode(h);window.open("data:application/sql;filename=exportData;"+d)}else{if(p.type=="json"){var f=[];a(e).find("thead").find("tr").each(function(){var x="";var w=[];a(this).filter(":visible").find("th").each(function(y,z){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(y)==-1){w.push(m(a(this)))}}});f.push(w)});var q=[];a(e).find("tbody").find("tr").each(function(){var x="";var w=[];a(this).filter(":visible").find("td").each(function(y,z){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(y)==-1){w.push(m(a(this)))}}});q.push(w)});var t=[];t.push({header:f,data:q});if(p.consoleLog=="true"){console.log(JSON.stringify(t))}var d="base64,"+a.base64.encode(JSON.stringify(t));window.open("data:application/json;filename=exportData;"+d)}else{if(p.type=="xml"){var j='<?xml version="1.0" encoding="utf-8"?>';j+="<tabledata><fields>";a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){j+="<field>"+m(a(this))+"</field>"}}})});j+="</fields><data>";var o=1;a(e).find("tbody").find("tr").each(function(){j+='<row id="'+o+'">';var w=0;a(this).filter(":visible").find("td").each(function(x,y){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(x)==-1){j+="<column-"+w+">"+m(a(this))+"</column-"+w+">"}}w++});o++;j+="</row>"});j+="</data></tabledata>";if(p.consoleLog=="true"){console.log(j)}var d="base64,"+a.base64.encode(j);window.open("data:application/xml;filename=exportData;"+d)}else{if(p.type=="excel"||p.type=="doc"||p.type=="powerpoint"){var b="<table>";a(e).find("thead").find("tr").each(function(){b+="<tr>";a(this).filter(":visible").find("th").each(function(w,x){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){b+="<td>"+m(a(this))+"</td>"}}});b+="</tr>"});var o=1;a(e).find("tbody").find("tr").each(function(){b+="<tr>";var w=0;a(this).filter(":visible").find("td").each(function(x,y){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(x)==-1){b+="<td>"+m(a(this))+"</td>"}}w++});o++;b+="</tr>"});b+="</table>";if(p.consoleLog=="true"){console.log(b)}var k="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+p.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";k+="<head>";k+="<!--[if gte mso 9]>";k+="<xml>";k+="<x:ExcelWorkbook>";k+="<x:ExcelWorksheets>";k+="<x:ExcelWorksheet>";k+="<x:Name>";k+="{worksheet}";k+="</x:Name>";k+="<x:WorksheetOptions>";k+="<x:DisplayGridlines/>";k+="</x:WorksheetOptions>";k+="</x:ExcelWorksheet>";k+="</x:ExcelWorksheets>";k+="</x:ExcelWorkbook>";k+="</xml>";k+="<![endif]-->";k+="</head>";k+="<body>";k+=b;k+="</body>";k+="</html>";var g="";if(p.type=="excel"){g="xls"}else{if(p.type=="doc"){g="doc"}}var c=new Blob([k],{type:"text/"+g});if(window.navigator.msSaveBlob){window.navigator.msSaveOrOpenBlob(c,"exportData"+new Date().toDateString()+"."+g)}else{var s=window.document.createElement("a");s.href=window.URL.createObjectURL(c,{type:"text/plain"});s.download="exportData"+new Date().toDateString()+"."+g;document.body.appendChild(s);s.click();document.body.removeChild(s)}}else{if(p.type=="png"){html2canvas(a(e),{onrendered:function(x){var w=x.toDataURL("image/png");window.open(w)}})}else{if(p.type=="pdf"){var v=new jsPDF("p","pt","a4",true);v.setFontSize(p.pdfFontSize);var n=p.pdfLeftMargin;a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(w,y){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(w)==-1){var x=n+(w*50);v.text(x,20,m(a(this)))}}})});var r=20;var l=1;var u=0;a(e).find("tbody").find("tr").each(function(w,x){rowCalc=w+1;if(rowCalc%26==0){v.addPage();l++;r=r+10}u=(r+(rowCalc*10))-((l-1)*280);a(this).filter(":visible").find("td").each(function(y,A){if(a(this).css("display")!="none"){if(p.ignoreColumn.indexOf(y)==-1){var z=n+(y*50);v.text(z,u,m(a(this)))}}})});v.output("datauriNew")}}}}}}}function m(w){if(p.htmlContent=="true"){content_data=w.html().trim()}else{content_data=w.text().trim()}if(p.escape=="true"){content_data=escape(content_data)}return content_data}}})})(jQuery);