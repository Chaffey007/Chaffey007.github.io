"use strict";function SVGMorpheus(b,a,d){if(!b){throw new Error('SVGMorpheus > "element" is required')}if(typeof b===typeof""){b=document.querySelector(b);if(!b){throw new Error('SVGMorpheus > "element" query is not related to an existing DOM node')}}if(!!a&&typeof a!==typeof{}){throw new Error('SVGMorpheus > "options" parameter must be an object')}a=a||{};if(!!d&&typeof d!==typeof(function(){})){throw new Error('SVGMorpheus > "callback" parameter must be a function')}var c=this;this._icons={};this._curIconId=a.iconId||"";this._toIconId="";this._curIconItems=[];this._fromIconItems=[];this._toIconItems=[];this._morphNodes=[];this._morphG;this._startTime;this._defDuration=a.duration||750;this._defEasing=a.easing||"quad-in-out";this._defRotation=a.rotation||"clock";this._defCallback=d||function(){};this._duration=this._defDuration;this._easing=this._defEasing;this._rotation=this._defRotation;this._callback=this._defCallback;this._rafid;this._fnTick=function(e){if(!c._startTime){c._startTime=e}var f=Math.min((e-c._startTime)/c._duration,1);c._updateAnimationProgress(f);if(f<1){c._rafid=_reqAnimFrame(c._fnTick)}else{if(c._toIconId!=""){c._animationEnd()}}};if(b.nodeName.toUpperCase()==="SVG"){this._svgDoc=b}else{this._svgDoc=b.getSVGDocument()}if(!this._svgDoc){b.addEventListener("load",function(){c._svgDoc=b.getSVGDocument();c._init()},false)}else{c._init()}}SVGMorpheus.prototype._init=function(){if(this._svgDoc.nodeName.toUpperCase()!=="SVG"){this._svgDoc=this._svgDoc.getElementsByTagName("svg")[0]}if(!!this._svgDoc){var m="",I,L,D,A,O,G,q,N;for(I=this._svgDoc.childNodes.length-1;I>=0;I--){var P=this._svgDoc.childNodes[I];if(P.nodeName.toUpperCase()==="G"){D=P.getAttribute("id");if(!!D){A=[];for(G=0,q=P.childNodes.length;G<q;G++){var Q=P.childNodes[G];O={path:"",attrs:{},style:{}};switch(Q.nodeName.toUpperCase()){case"PATH":O.path=Q.getAttribute("d");break;case"CIRCLE":var d=Q.getAttribute("cx")*1,b=Q.getAttribute("cy")*1,z=Q.getAttribute("r")*1;O.path="M"+(d-z)+","+b+"a"+z+","+z+" 0 1,0 "+(z*2)+",0a"+z+","+z+" 0 1,0 -"+(z*2)+",0z";break;case"ELLIPSE":var d=Q.getAttribute("cx")*1,b=Q.getAttribute("cy")*1,g=Q.getAttribute("rx")*1,f=Q.getAttribute("ry")*1;O.path="M"+(d-g)+","+b+"a"+g+","+f+" 0 1,0 "+(g*2)+",0a"+g+","+f+" 0 1,0 -"+(g*2)+",0z";break;case"RECT":var u=Q.getAttribute("x")*1,t=Q.getAttribute("y")*1,v=Q.getAttribute("width")*1,K=Q.getAttribute("height")*1,g=Q.getAttribute("rx")*1,f=Q.getAttribute("ry")*1;if(!g&&!f){O.path="M"+u+","+t+"l"+v+",0l0,"+K+"l-"+v+",0z"}else{O.path="M"+(u+g)+","+t+"l"+(v-g*2)+",0a"+g+","+f+" 0 0,1 "+g+","+f+"l0,"+(K-f*2)+"a"+g+","+f+" 0 0,1 -"+g+","+f+"l"+(g*2-v)+",0a"+g+","+f+" 0 0,1 -"+g+",-"+f+"l0,"+(f*2-K)+"a"+g+","+f+" 0 0,1 "+g+",-"+f+"z"}break;case"POLYGON":var H=Q.getAttribute("points");var C=H.split(/\s+/);var B="";for(var F=0,L=C.length;F<L;F++){B+=(F&&"L"||"M")+C[F]}O.path=B+"z";break;case"LINE":var M=Q.getAttribute("x1")*1,c=Q.getAttribute("y1")*1,J=Q.getAttribute("x2")*1,a=Q.getAttribute("y2")*1;O.path="M"+M+","+c+"L"+J+","+a+"z";break}if(O.path!=""){for(var F=0,o=Q.attributes.length;F<o;F++){var s=Q.attributes[F];if(s.specified){var S=s.name.toLowerCase();switch(S){case"fill":case"fill-opacity":case"opacity":case"stroke":case"stroke-opacity":case"stroke-width":O.attrs[S]=s.value}}}for(var E=0,n=Q.style.length;E<n;E++){var e=Q.style[E];switch(e){case"fill":case"fill-opacity":case"opacity":case"stroke":case"stroke-opacity":case"stroke-width":O.style[e]=Q.style[e]}}A.push(O)}}if(A.length>0){N={id:D,items:A};this._icons[D]=N}if(!this._morphG){m=D;this._morphG=document.createElementNS("http://www.w3.org/2000/svg","g");this._svgDoc.replaceChild(this._morphG,P)}else{this._svgDoc.removeChild(P)}}}}var R=this._curIconId||m;if(R!==""){this._setupAnimation(R);this._updateAnimationProgress(1);this._animationEnd()}}};SVGMorpheus.prototype._setupAnimation=function(l){if(!!l&&!!this._icons[l]){this._toIconId=l;this._startTime=undefined;var k,n,h,g;this._fromIconItems=clone(this._curIconItems);this._toIconItems=clone(this._icons[l].items);for(k=0,n=this._morphNodes.length;k<n;k++){var p=this._morphNodes[k];p.fromIconItemIdx=k;p.toIconItemIdx=k}var e=Math.max(this._fromIconItems.length,this._toIconItems.length);var c;for(k=0;k<e;k++){if(!this._fromIconItems[k]){if(!!this._toIconItems[k]){c=curvePathBBox(path2curve(this._toIconItems[k].path));this._fromIconItems.push({path:"M"+c.cx+","+c.cy+"l0,0",attrs:{},style:{},trans:{rotate:[0,c.cx,c.cy]}})}else{this._fromIconItems.push({path:"M0,0l0,0",attrs:{},style:{},trans:{rotate:[0,0,0]}})}}if(!this._toIconItems[k]){if(!!this._fromIconItems[k]){c=curvePathBBox(path2curve(this._fromIconItems[k].path));this._toIconItems.push({path:"M"+c.cx+","+c.cy+"l0,0",attrs:{},style:{},trans:{rotate:[0,c.cx,c.cy]}})}else{this._toIconItems.push({path:"M0,0l0,0",attrs:{},style:{},trans:{rotate:[0,0,0]}})}}if(!this._morphNodes[k]){var f=document.createElementNS("http://www.w3.org/2000/svg","path");this._morphG.appendChild(f);this._morphNodes.push({node:f,fromIconItemIdx:k,toIconItemIdx:k})}}for(k=0;k<e;k++){var o=this._fromIconItems[k];var b=this._toIconItems[k];var r=path2curve(this._fromIconItems[k].path,this._toIconItems[k].path);o.curve=r[0];b.curve=r[1];var m=styleToNorm(this._fromIconItems[k].attrs,this._toIconItems[k].attrs);o.attrsNorm=m[0];b.attrsNorm=m[1];o.attrs=styleNormToString(o.attrsNorm);b.attrs=styleNormToString(b.attrsNorm);var d=styleToNorm(this._fromIconItems[k].style,this._toIconItems[k].style);o.styleNorm=d[0];b.styleNorm=d[1];o.style=styleNormToString(o.styleNorm);b.style=styleNormToString(b.styleNorm);c=curvePathBBox(b.curve);b.trans={rotate:[0,c.cx,c.cy]};var q=this._rotation,a;if(q==="random"){q=Math.random()<0.5?"counterclock":"clock"}switch(q){case"none":if(!!o.trans.rotate){b.trans.rotate[0]=o.trans.rotate[0]}break;case"counterclock":if(!!o.trans.rotate){b.trans.rotate[0]=o.trans.rotate[0]-360;a=-o.trans.rotate[0]%360;b.trans.rotate[0]+=(a<180?a:a-360)}else{b.trans.rotate[0]=-360}break;default:if(!!o.trans.rotate){b.trans.rotate[0]=o.trans.rotate[0]+360;a=o.trans.rotate[0]%360;b.trans.rotate[0]+=(a<180?-a:360-a)}else{b.trans.rotate[0]=360}break}}this._curIconItems=clone(this._fromIconItems)}};SVGMorpheus.prototype._updateAnimationProgress=function(e){e=easings[this._easing](e);var f,d,b,a;for(f=0,a=this._curIconItems.length;f<a;f++){this._curIconItems[f].curve=curveCalc(this._fromIconItems[f].curve,this._toIconItems[f].curve,e);this._curIconItems[f].path=path2string(this._curIconItems[f].curve);this._curIconItems[f].attrsNorm=styleNormCalc(this._fromIconItems[f].attrsNorm,this._toIconItems[f].attrsNorm,e);this._curIconItems[f].attrs=styleNormToString(this._curIconItems[f].attrsNorm);this._curIconItems[f].styleNorm=styleNormCalc(this._fromIconItems[f].styleNorm,this._toIconItems[f].styleNorm,e);this._curIconItems[f].style=styleNormToString(this._curIconItems[f].styleNorm);this._curIconItems[f].trans=transCalc(this._fromIconItems[f].trans,this._toIconItems[f].trans,e);this._curIconItems[f].transStr=trans2string(this._curIconItems[f].trans)}for(f=0,a=this._morphNodes.length;f<a;f++){var h=this._morphNodes[f];h.node.setAttribute("d",this._curIconItems[f].path);var c=this._curIconItems[f].attrs;for(d in c){h.node.setAttribute(d,c[d])}var g=this._curIconItems[f].style;for(b in g){h.node.style[b]=g[b]}h.node.setAttribute("transform",this._curIconItems[f].transStr)}};SVGMorpheus.prototype._animationEnd=function(){for(var a=this._morphNodes.length-1;a>=0;a--){var b=this._morphNodes[a];if(!!this._icons[this._toIconId].items[a]){b.node.setAttribute("d",this._icons[this._toIconId].items[a].path)}else{b.node.parentNode.removeChild(b.node);this._morphNodes.splice(a,1)}}this._curIconId=this._toIconId;this._toIconId="";this._callback()};SVGMorpheus.prototype.to=function(b,a,c){if(b!==this._toIconId){if(!!a&&typeof a!==typeof{}){throw new Error('SVGMorpheus.to() > "options" parameter must be an object')}a=a||{};if(!!c&&typeof c!==typeof(function(){})){throw new Error('SVGMorpheus.to() > "callback" parameter must be a function')}_cancelAnimFrame(this._rafid);this._duration=a.duration||this._defDuration;this._easing=a.easing||this._defEasing;this._rotation=a.rotation||this._defRotation;this._callback=c||this._defCallback;this._setupAnimation(b);this._rafid=_reqAnimFrame(this._fnTick)}};SVGMorpheus.prototype.registerEasing=function(a,b){easings[a]=b};if(typeof define==="function"&&define.amd){define(function(){return SVGMorpheus})}else{if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=SVGMorpheus}else{window.SVGMorpheus=SVGMorpheus}};